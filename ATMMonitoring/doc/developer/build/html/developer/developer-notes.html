

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Developer Notes &mdash; ATMMonitoring 1.0 documentation</title>
    
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="ATMMonitoring 1.0 documentation" href="../index.html" />
    <link rel="up" title="Architecture" href="../architecture/architecture.html" />
    <link rel="next" title="ATMMonitoring Javadocs" href="javadoc.html" />
    <link rel="prev" title="Deployment Diagram" href="../architecture/deployment-diagram.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="javadoc.html" title="ATMMonitoring Javadocs"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../architecture/deployment-diagram.html" title="Deployment Diagram"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">ATMMonitoring 1.0 documentation</a> &raquo;</li>
          <li><a href="../architecture/architecture.html" accesskey="U">Architecture</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="developer-notes">
<h1>Developer Notes<a class="headerlink" href="#developer-notes" title="Permalink to this headline">¶</a></h1>
<div class="section" id="code-structure">
<h2>Code Structure<a class="headerlink" href="#code-structure" title="Permalink to this headline">¶</a></h2>
<p>The whole program was designed in the usual way for a Spring/Hibernate one, with the following logical layers from bottom to top:</p>
<ol class="arabic simple">
<li>POJOs (Plain Old Java Object): the objects that store the DB entities&#8217; data. We have one class for each entity (DB table), and they
describe our complete DB model.</li>
<li>DAO: we have both facades and actual implementations, and they are the ones responsible for calling the Hibernate methods used
for retrieving, creating, updating and deleting data from the DB. Their functions are intended to be simple and atomic, with little
business logic. There is one DAO class for each POJO class.</li>
<li>Service: we have again both facades and implementations. Services are the ones in charge of doing most of the business logic,
including calling the DAOs they need. We have one Service class for each one of the POJO classes, though some of them are really
scarcely used and their main purpose right now is to keep code more organised. We also have an additional Service for the Socket
communication with the ATMs.</li>
<li>Controllers: the classes that map the URLs with the methods to execute and servlets to deliver for each of them. We have one Controller
for each of the main POJOs that will have their own GUIs, each one with a method for each GET/POST URL, which in most cases return either
a JSP file name or a redirect order.</li>
</ol>
<p>Besides all these classes, we also have some additional ones for very specific purposes: some classes for the Socket communication,
including two Exceptions; one that wraps the queries&#8217; operations; and an Utils that contains a bunch of static methods that are used
in several places.
And we have the JSP (JavaServer Pages) files (under src/main/webapp/WEB-INF/jsp), which contain the code that produces the HTML (with
JavaScript and CSS) for our pages. There are also tags, jsp code used in many places and wrapped in a different file for avoiding
code repetition.
As any other Spring/Hibernate application, we also have the xml config files (pom, web, applicationContext...), config properties
files (messages with the translation strings, jdbc with the DB config, log4j with those properties, config with application-specific
options and inventory with the agent project ones), JavaScript libraries, CSS style sheets and images.</p>
</div>
<div class="section" id="sensitive-code-sections">
<h2>Sensitive code sections<a class="headerlink" href="#sensitive-code-sections" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li>Query designer comboboxes: the comboboxes for the queries design page are filled in a way that is intended to be easily modifiable. For
achieving this we created the class Operation, which is the one that does all low level real work related to the query operations. First of all,
it stores in several structures the data related to those operations. In one of them it stores a mapping from the operations string ids
to an enum values (the enum allows us to use a switch sentence). It also has another structure that holds all the operations allowed for
each data type, along with a boolean that tells us whether the operation needs a parameter or not (e.g. Is Null does not need a parameter).
Above the Operation, the POJOs of the entities referred in the comboboxes create another structure for storing the fields for the comboboxes
with their proper operations retrieved from Operation based on their data type. In the jsp file queries we create a JavaScript structure
based on that HashMap with the whole comboboxes config, which we will use to populated the comboboxes through JavaScript on demand.</li>
<li>Version storage: most version fields are stored in five independent fields in DB: major version, minor version, build version, revision
version and remaining version. The first four fields store the usual version numbers as integers, and the last one stores a string with
the remaining characters (e.g. 1.2.43.21.alpha), or the whole version in case it can&#8217;t be parsed in the other fields. In every case we store
a version this way we also have commodity functions for both retrieving and setting the whole version as a string with one call.</li>
<li>Socket sinchronization: all the Socket sinchronization code is included in the subpackage &#8216;socket&#8217;. This includes the service with the methods
called from the proper Controller, and the SocketListener which is the one that does the Socket requests and response reception itself. This
Listener includes a &#64;PostConstruct annotated method that creates the response listener and a &#64;PreDestruct method that releases the resources
used by the listener before destroying the servlet. It&#8217;s also important pointing that the ScheduledUpdateService includes a &#64;Scheduled
annotated method which checks the scheduled updates according to the cron expression (each minute by default) and calls the SocketService
function for updating the proper Terminals in case we have a scheduled update.</li>
</ol>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/logo.png" alt="Logo"/>
            </a></p>
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Developer Notes</a><ul>
<li><a class="reference internal" href="#code-structure">Code Structure</a></li>
<li><a class="reference internal" href="#sensitive-code-sections">Sensitive code sections</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="../architecture/deployment-diagram.html"
                        title="previous chapter">Deployment Diagram</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="javadoc.html"
                        title="next chapter">ATMMonitoring Javadocs</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/developer/developer-notes.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="javadoc.html" title="ATMMonitoring Javadocs"
             >next</a> |</li>
        <li class="right" >
          <a href="../architecture/deployment-diagram.html" title="Deployment Diagram"
             >previous</a> |</li>
        <li><a href="../index.html">ATMMonitoring 1.0 documentation</a> &raquo;</li>
          <li><a href="../architecture/architecture.html" >Architecture</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2014, NCR.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>